#!/bin/bash
# Auto-generated script for trust certificate installation
# Generated by docker-gen when containers change

set -e

# Source required functions
source /app/scripts/docker-api-functions.sh
source /app/scripts/os-detection.sh
source /app/scripts/trust-functions.sh

log() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] TRUST-GEN: $1"
}

# Process trust certificate installation
{{range $container := .}}
{{if $container.Env.STEP_CA_TRUST}}
log "Installing trust certificate for container: {{$container.Name}} (ID: {{$container.ID}})"
log "Processing trust certificate for container: {{$container.Name}} (ID: {{$container.ID}})"
install_trust_certificate "{{$container.ID}}" "{{$container.Name}}"
if [ $? -eq 0 ]; then
    log "Trust certificate successfully installed in container: {{$container.Name}}"
else
    log "Failed to install trust certificate in container: {{$container.Name}}"
fi
{{end}}
{{end}}

log "Trust certificate processing completed"